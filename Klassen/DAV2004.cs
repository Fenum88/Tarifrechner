using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Collections.Generic;
using System.Globalization;
using System.Formats.Asn1;

namespace Tarifrechner.Klassen
{
    public class DAV2004
    {

        //=WENN(A4<1999;"";WENN(A4<=1999+T_1;1;WENN(A4<=1999+T_2;1-(A4-1999-T_1)*(A4-1999-T_1-1)/(2*(T_2-T_1)*(A4-1999));(T_1+T_2+1)/(2*(A4-1999)))))*(A4-1999)
        public Dictionary<int, double> Gewichte = new Dictionary<int, double>();
        public List<Tafel> TafelListe { get; set; }

        public double T_1 = 5.0;
        public double T_2 = 10.0;
        public int Policenbeginnjahr = 2019;
        public int Eintrittsalter = 40;
        public int n = 10;
        private double[][] Aggregattafel_1_O = [
            [
                0.003439    ,0.000317    ,0.000214    ,0.000158    ,0.000122    ,0.000108    ,
                0.000102    ,0.000087    ,0.000099    ,0.000084    ,0.000083    ,0.000098    ,
                0.000104    ,0.000114    ,0.000140    ,0.000192    ,0.000276    ,0.000364    ,
                0.000596    ,0.000630    ,0.000627    ,0.000636    ,0.000625    ,0.000642    ,
                0.000622    ,0.000617    ,0.000616    ,0.000627    ,0.000613    ,0.000603    ,
                0.000598    ,0.000605    ,0.000626    ,0.000663    ,0.000713    ,0.000775    ,
                0.000850    ,0.000944    ,0.001047    ,0.001153    ,0.001261    ,0.001372    ,
                0.001483    ,0.001603    ,0.001732    ,0.001871    ,0.002025    ,0.002194    ,
                0.002373    ,0.002563    ,0.002762    ,0.002981    ,0.003212    ,0.003449    ,
                0.003684    ,0.003911    ,0.004134    ,0.004370    ,0.004627    ,0.004932    ,
                0.005299    ,0.005777    ,0.006383    ,0.007119    ,0.007963    ,0.008886    ,
                0.009938    ,0.011253    ,0.012687    ,0.014231    ,0.015887    ,0.017663    ,
                0.019598    ,0.021698    ,0.023990    ,0.026610    ,0.029533    ,0.032873    ,
                0.036696    ,0.041106    ,0.046239    ,0.052094    ,0.058742    ,0.066209    ,
                0.074583    ,0.083899    ,0.094103    ,0.105171    ,0.116929    ,0.129206    ,
                0.141850    ,0.154860    ,0.168157    ,0.181737    ,0.195567    ,0.209614    ,
                0.223854    ,0.238280    ,0.252858    ,0.267526    ,0.278816    ,0.293701    ,
                0.308850    ,0.324261    ,0.339936    ,0.355873    ,0.372069    ,0.388523    ,
                0.405229    ,0.422180    ,0.439368    ,0.456782    ,0.474411    ,0.492237    ,
                0.510241    ,0.528401    ,0.546689    ,0.565074    ,0.583517    ,0.601976    ,
                0.620400    ,1.000000    ,],
                [0.0026940  ,0.0002800   ,0.0001600   ,0.0001240   ,0.0001010   ,0.0000780   ,
                0.0000810   ,0.0000800   ,0.0000690   ,0.0000680   ,0.0000660   ,0.0000710   ,
                    0.0000750   ,0.0000790   ,0.0000920   ,0.0001200   ,0.0001440   ,0.0001660   ,
                    0.0002350   ,0.0002380   ,0.0002300   ,0.0002110   ,0.0002150   ,0.0002010   ,
                    0.0002220   ,0.0002250   ,0.0002250   ,0.0002350   ,0.0002580   ,0.0002800   ,
                    0.0002910   ,0.0003020   ,0.0003180   ,0.0003440   ,0.0003850   ,0.0004340   ,
                    0.0004880   ,0.0005470   ,0.0006050   ,0.0006660   ,0.0007350   ,0.0008090   ,
                    0.0008850   ,0.0009590   ,0.0010330   ,0.0011130   ,0.0012030   ,0.0013010   ,
                    0.0014060   ,0.0015120   ,0.0016160   ,0.0017200   ,0.0018220   ,0.0019310   ,
                    0.0020520   ,0.0021860   ,0.0023400   ,0.0025160   ,0.0027060   ,
                    0.0029140   ,0.0031450   ,0.0034020   ,0.0036920   ,0.0040210   ,0.0043840   ,
                    0.0048300   ,0.0052780   ,0.0059050   ,0.0066740   ,0.0075480   ,
                    0.0085250   ,0.0096790   ,0.0109650   ,0.0123410   ,0.0139090   ,0.0157060   ,
                    0.0176720   ,0.0197220   ,0.0221020   ,0.0249750   ,0.0285350   ,0.0329470   ,
                    0.0383400   ,0.0446650   ,0.0517370   ,0.0595410   ,0.0681870   ,0.0776840   ,0.0879110   ,0.0986620   ,0.1096140   ,
                    0.1205100   ,0.1313830   ,0.1422650   ,0.1531850   ,0.1641280   ,0.1750650   ,0.1859580   ,0.1968240   ,
                    0.2076670   ,0.2297390   ,0.2433500   ,0.2573190   ,0.2716550   ,0.2863680   ,0.3014670   ,0.3169620   ,
                    0.3328600   ,0.3491690   ,0.3658960   ,0.3830460   ,0.4006220   ,0.4186260   ,0.4370550   ,0.4559060   ,
                    0.4751700   ,0.4948320   ,0.5148720   ,0.5352640   ,0.5559690   ,0.5769420   ,1.0000000   ,
                    ]];
        private double[][] Aggregattafel_2_O = [[
                0.004076    ,0.000375    ,0.000253    ,0.000187    ,0.000145    ,0.000128    ,0.000121    ,0.000104    ,0.000117    ,
                0.000100    ,0.000098    ,0.000117    ,0.000123    ,0.000135    ,0.000165    ,0.000228    ,0.000328    ,
                0.000432    ,0.000707    ,0.000747    ,0.000743    ,0.000754    ,0.000741    ,0.000761    ,0.000737    ,
                0.000731    ,0.000730    ,0.000743    ,0.000726    ,0.000715    ,0.000709    ,0.000717    ,0.000742    ,
                0.000786    ,0.000845    ,0.000918    ,0.001008    ,0.001119    ,0.001242    ,0.001367    ,0.001495    ,
                0.001626    ,0.001758    ,0.001900    ,0.002053    ,0.002217    ,0.002400    ,0.002601    ,0.002813    ,
                0.003038    ,0.003274    ,0.003534    ,0.003807    ,0.004088    ,0.004367    ,0.004636    ,0.004901    ,
                0.005179    ,0.005485    ,0.005846    ,0.006281    ,0.006848    ,0.007566    ,0.008438    ,0.009439    ,
                0.010533    ,0.011779    ,0.013339    ,0.015038    ,0.016869    ,0.018832    ,0.020937    ,0.023230    ,
                0.025719    ,0.028436    ,0.031542    ,0.035006    ,0.038965    ,0.043496    ,0.048724    ,0.054808    ,
                0.061748    ,0.069628    ,0.078479    ,0.088405    ,0.099447    ,0.111543    ,0.124661    ,0.138599    ,
                0.153150    ,0.168138    ,0.183559    ,0.199321    ,0.215417    ,0.231810    ,0.248460    ,0.265339    ,
                0.282439    ,0.299718    ,0.317104    ,0.330487    ,0.348131    ,0.366086    ,0.384354    ,0.402934    ,
                0.421824    ,0.441023    ,0.460525    ,0.480327    ,0.500419    ,0.520793    ,0.541435    ,0.562330    ,
                0.583459    ,0.604801    ,0.626326    ,0.648003    ,0.669795    ,0.691657    ,0.713536    ,0.735375    ,
                1.000000    ,],[0.003226    ,0.000335    ,0.000192    ,0.000148    ,0.000120    ,0.000094    ,0.000097    ,0.000096    ,0.000082    ,
                0.000082    ,0.000079    ,0.000085    ,0.000090    ,0.000094    ,0.000110    ,0.000144    ,0.000173    ,
                0.000199    ,0.000282    ,0.000285    ,0.000275    ,0.000252    ,0.000257    ,0.000240    ,0.000266    ,
                0.000270    ,0.000270    ,0.000281    ,0.000309    ,0.000335    ,0.000348    ,0.000361    ,0.000381    ,
                0.000413    ,0.000461    ,0.000519    ,0.000585    ,0.000656    ,0.000725    ,0.000798    ,0.000881    ,
                0.000968    ,0.001059    ,0.001149    ,0.001237    ,0.001332    ,0.001440    ,0.001558    ,0.001683    ,
                0.001811    ,0.001935    ,0.002060    ,0.002182    ,0.002312    ,0.002458    ,0.002618    ,0.002803    ,
                0.003013    ,0.003240    ,0.003490    ,0.003766    ,0.004074    ,0.004421    ,0.004815    ,0.005250    ,
                0.005783    ,0.006321    ,0.007071    ,0.007992    ,0.009039    ,0.010209    ,0.011591    ,0.013131    ,
                0.014778    ,0.016656    ,0.018808    ,0.021163    ,0.023618    ,0.026468    ,0.029908    ,0.034171    ,
                0.039454    ,0.045913    ,0.053487    ,0.061956    ,0.071302    ,0.081656    ,0.093028    ,0.105275    ,
                0.118149    ,0.131265    ,0.144313    ,0.157333    ,0.170365    ,0.183442    ,0.196546    ,0.209643    ,
                0.222688    ,0.235701    ,0.248685    ,0.275117    ,0.291416    ,0.308144    ,0.325311    ,0.342930    ,
                0.361012    ,0.379567    ,0.398606    ,0.418136    ,0.438167    ,0.458705    ,0.479752    ,0.501312    ,
                0.523382    ,0.545956    ,0.569024    ,0.592570    ,0.616569    ,0.640988    ,0.665783    ,0.690898    ,1.000000    ,]];
        private double[][] Aggregattafel_Bestand = [[
                0.003821    ,0.000352    ,0.000237    ,0.000176    ,0.000136    ,0.000120    ,0.000114    ,0.000097    ,
                0.000110    ,0.000093    ,0.000092    ,0.000109    ,0.000115    ,0.000127    ,0.000155    ,0.000214    ,
                0.000307    ,0.000405    ,0.000663    ,0.000700    ,0.000697    ,0.000707    ,0.000694    ,0.000713    ,
                0.000691    ,0.000686    ,0.000684    ,0.000697    ,0.000681    ,0.000670    ,0.000665    ,0.000672    ,
                0.000695    ,0.000736    ,0.000792    ,0.000861    ,0.000945    ,0.001049    ,0.001164    ,0.001281    ,
                0.001401    ,0.001524    ,0.001648    ,0.001781    ,0.001924    ,0.002079    ,0.002250    ,0.002438    ,
                0.002637    ,0.002848    ,0.003069    ,0.003312    ,0.003568    ,0.003832    ,0.004093    ,0.004346    ,
                0.004594    ,0.004855    ,0.005142    ,0.005480    ,0.005888    ,0.006419    ,0.007092    ,0.007909    ,
                0.008848    ,0.009873    ,0.011042    ,0.012504    ,0.014097    ,0.015813    ,0.017653    ,0.019626    ,
                0.021775    ,0.024109    ,0.026656    ,0.029567    ,0.032815    ,0.036525    ,0.040773    ,0.045673    ,
                0.051377    ,0.057882    ,0.065269    ,0.073565    ,0.082870    ,0.093221    ,0.104559    ,0.116856    ,
                0.129921    ,0.143562    ,0.157611    ,0.172067    ,0.186841    ,0.201930    ,0.217297    ,0.232904    ,
                0.248727    ,0.264756    ,0.280953    ,0.297251    ,0.309795    ,0.326335    ,0.343166    ,0.360290    ,
                0.377706    ,0.395414    ,0.413411    ,0.431692    ,0.450254    ,0.469088    ,0.488186    ,0.507536    ,
                0.527123    ,0.546930    ,0.566935    ,0.587112    ,0.607432    ,0.627860    ,0.648353    ,0.668862    ,
                0.689333    ,0.000000    ,]];
        private double[][] f = [[0.670538, 0.876209], [0.712823, 0.798230]];
        private double[][] F_1_O = [[
                    0.03303985  ,0.03303985  ,0.03303985  ,0.03303985  ,0.03303985  ,0.03303985  ,0.03303985  ,0.03303985  ,
                    0.03303985  ,0.03303985  ,0.03303985  ,0.03303985  ,0.03303985  ,0.03303985  ,0.03303985  ,0.03303985  ,
                    0.03303985  ,0.03303985  ,0.03303985  ,0.03303985  ,0.03303985  ,0.03303985  ,0.03303985  ,0.03301381  ,
                    0.03138903  ,0.03009490  ,0.02911046  ,0.02839963  ,0.02793402  ,0.02765640  ,0.02750067  ,0.02740031  ,
                    0.02730804  ,0.02719391  ,0.02706035  ,0.02695565  ,0.02691229  ,0.02690961  ,0.02690928  ,0.02688675  ,
                    0.02684974  ,0.02682919  ,0.02681278  ,0.02679602  ,0.02675173  ,0.02666774  ,0.02654651  ,0.02638875  ,
                    0.02620949  ,0.02602928  ,0.02587807  ,0.02577098  ,0.02567549  ,0.02558704  ,0.02550013  ,0.02540298  ,
                    0.02528317  ,0.02514256  ,0.02499636  ,0.02486849  ,0.02479571  ,0.02480715  ,0.02492644  ,0.02515644  ,
                    0.02549022  ,0.02591357  ,0.02639617  ,0.02690595  ,0.02741577  ,0.02788177  ,0.02826066  ,0.02851318  ,
                    0.02862041  ,0.02856339  ,0.02833777  ,0.02795026  ,0.02741783  ,0.02675811  ,0.02599351  ,0.02514346  ,
                    0.02423250  ,0.02327100  ,0.02227796  ,0.02129226  ,0.02034403  ,0.01943234  ,0.01855670  ,0.01770100  ,
                    0.01684261  ,0.01597498  ,0.01516333  ,0.01446271  ,0.01387288  ,0.01339365  ,0.01302486  ,0.01276639  ,
                    0.01261815  ,0.01257878  ,0.01257878  ,0.01257878  ,0.01257878  ,0.01257878  ,0.01257878  ,0.01257878  ,
                    0.01257878  ,0.01257878  ,0.01257878  ,0.01257878  ,0.01257878  ,0.01257878  ,0.01257878  ,0.01257878  ,
                    0.01257878  ,0.01257878  ,0.01257878  ,0.01257878  ,0.01257878  ,0.01257878  ,0.01257878  ,0.01257878  ,
                    0.01257878  ,0.00000000  ,],
                    [0.03303985 ,0.03303985  ,0.03303985  ,0.03303985  ,0.03303985  ,0.03303985  ,0.03303985  ,0.03303985  ,0.03303985  ,
                    0.03303985  ,0.03303985  ,0.03303985  ,0.03303985  ,0.03303985  ,0.03303985  ,0.03303985  ,0.03303985  ,
                    0.03303985  ,0.03303985  ,0.03303985  ,0.03303985  ,0.03303985  ,0.03303985  ,0.03298816  ,0.03287161  ,
                    0.03278166  ,0.03268512  ,0.03252693  ,0.03226875  ,0.03193675  ,0.03152501  ,0.03094365  ,0.03014668  ,
                    0.02914996  ,0.02801054  ,0.02682974  ,0.02567995  ,0.02464377  ,0.02377300  ,0.02305650  ,0.02248214  ,
                    0.02207810  ,0.02185396  ,0.02178902  ,0.02185910  ,0.02202052  ,0.02225316  ,0.02252168  ,0.02280602  ,
                    0.02310876  ,0.02341569  ,0.02372758  ,0.02401966  ,0.02425692  ,0.02442806  ,0.02453498  ,0.02457210  ,
                    0.02455016  ,0.02447892  ,0.02436478  ,0.02424808  ,0.02417359  ,0.02418705  ,0.02432563  ,0.02459119  ,
                    0.02494674  ,0.02535629  ,0.02580147  ,0.02627101  ,0.02675603  ,0.02722831  ,0.02765966  ,0.02802468  ,
                    0.02831732  ,0.02851150  ,0.02859209  ,0.02854652  ,0.02837159  ,0.02806358  ,0.02763160  ,0.02706955  ,
                    0.02637873  ,0.02556878  ,0.02465783  ,0.02366759  ,0.02261230  ,0.02151662  ,0.02039770  ,0.01927338  ,
                    0.01814674  ,0.01707808  ,0.01612386  ,0.01528376  ,0.01455749  ,0.01394480  ,0.01344549  ,0.01305938  ,
                    0.01278634  ,0.01262629  ,0.01257878  ,0.01257878  ,0.01257878  ,0.01257878  ,0.01257878  ,0.01257878  ,
                    0.01257878  ,0.01257878  ,0.01257878  ,0.01257878  ,0.01257878  ,0.01257878  ,0.01257878  ,0.01257878  ,
                    0.01257878  ,0.01257878  ,0.01257878  ,0.01257878  ,0.01257878  ,0.01257878  ,0.01257878  ,0.01257878  ,
                    0.00000000  ,]];
        private double[][] F_1_2_O = [[
                    0.03045921  ,0.03045921  ,0.03045921  ,0.03045921  ,0.03045921  ,0.03045921  ,0.03045921  ,0.03045921  ,
                    0.03045921  ,0.03045921  ,0.03045921  ,0.03045921  ,0.03045921  ,0.03045921  ,0.03045921  ,0.03045921  ,
                    0.03045921  ,0.03045921  ,0.03045921  ,0.03045921  ,0.03045921  ,0.03045921  ,0.03045921  ,0.03043323  ,
                    0.02881264  ,0.02752183  ,0.02653992  ,0.02583092  ,0.02536650  ,0.02508959  ,0.02493426  ,0.02483416  ,
                    0.02474212  ,0.02462828  ,0.02449507  ,0.02439063  ,0.02434739  ,0.02434472  ,0.02434439  ,0.02432191  ,
                    0.02428500  ,0.02426450  ,0.02424813  ,0.02423142  ,0.02418724  ,0.02410346  ,0.02398254  ,0.02382519  ,
                    0.02364638  ,0.02346664  ,0.02331582  ,0.02320900  ,0.02311376  ,0.02302553  ,0.02293885  ,0.02284194  ,
                    0.02272244  ,0.02258219  ,0.02243636  ,0.02230882  ,0.02223622  ,0.02224764  ,0.02236662  ,0.02259603  ,
                    0.02292896  ,0.02335122  ,0.02383259  ,0.02434107  ,0.02484958  ,0.02531438  ,0.02569230  ,0.02594418  ,
                    0.02605113  ,0.02599425  ,0.02576921  ,0.02538270  ,0.02485163  ,0.02419360  ,0.02343096  ,0.02258309  ,
                    0.02167445  ,0.02071541  ,0.01972490  ,0.01874172  ,0.01779590  ,0.01688653  ,0.01601311  ,0.01515958  ,
                    0.01430337  ,0.01343795  ,0.01262835  ,0.01192950  ,0.01134117  ,0.01086315  ,0.01049529  ,0.01023747  ,
                    0.01008961  ,0.01005034  ,0.01005034  ,0.01005034  ,0.01005034  ,0.01005034  ,0.01005034  ,0.01005034  ,
                    0.01005034  ,0.01005034  ,0.01005034  ,0.01005034  ,0.01005034  ,0.01005034  ,0.01005034  ,0.01005034  ,
                    0.01005034  ,0.01005034  ,0.01005034  ,0.01005034  ,0.01005034  ,0.01005034  ,0.01005034  ,0.01005034  ,0.01005034  ,0.00000000  ,],
                   [0.03045921  ,0.03045921  ,0.03045921  ,0.03045921  ,0.03045921  ,0.03045921  ,0.03045921  ,0.03045921  ,
                    0.03045921  ,0.03045921  ,0.03045921  ,0.03045921  ,0.03045921  ,0.03045921  ,0.03045921  ,0.03045921  ,
                    0.03045921  ,0.03045921  ,0.03045921  ,0.03045921  ,0.03045921  ,0.03045921  ,0.03045921  ,0.03040765  ,
                    0.03029140  ,0.03020168  ,0.03010539  ,0.02994760  ,0.02969009  ,0.02935894  ,0.02894826  ,0.02836840  ,
                    0.02757348  ,0.02657932  ,0.02544282  ,0.02426505  ,0.02311820  ,0.02208468  ,0.02121613  ,0.02050145  ,
                    0.01992856  ,0.01952555  ,0.01930199  ,0.01923720  ,0.01930711  ,0.01946812  ,0.01970017  ,0.01996800  ,
                    0.02025161  ,0.02055358  ,0.02085973  ,0.02117083  ,0.02146215  ,0.02169881  ,0.02186952  ,0.02197616  ,
                    0.02201318  ,0.02199130  ,0.02192024  ,0.02180639  ,0.02169000  ,0.02161569  ,0.02162912  ,0.02176735  ,
                    0.02203222  ,0.02238686  ,0.02279537  ,0.02323941  ,0.02370775  ,0.02419153  ,0.02466260  ,0.02509284  ,
                    0.02545692  ,0.02574882  ,0.02594249  ,0.02602289  ,0.02597743  ,0.02580295  ,0.02549572  ,0.02506486  ,
                    0.02450425  ,0.02381520  ,0.02300732  ,0.02209869  ,0.02111098  ,0.02005839  ,0.01896550  ,0.01784943  ,
                    0.01672797  ,0.01560419  ,0.01453824  ,0.01358644  ,0.01274847  ,0.01202404  ,0.01141290  ,0.01091485  ,
                    0.01052972  ,0.01025737  ,0.01009773  ,0.01005034  ,0.01005034  ,0.01005034  ,0.01005034  ,0.01005034  ,
                    0.01005034  ,0.01005034  ,0.01005034  ,0.01005034  ,0.01005034  ,0.01005034  ,0.01005034  ,0.01005034  ,
                    0.01005034  ,0.01005034  ,0.01005034  ,0.01005034  ,0.01005034  ,0.01005034  ,0.01005034  ,0.01005034  ,
                    0.01005034  ,0.00000000  ,] ];
        private double[][] F_2_2_O = [[
                        0.02275699  ,0.02275699  ,0.02275699  ,0.02275699  ,0.02275699  ,0.02275699  ,0.02275699  ,0.02275699  ,
                    0.02275699  ,0.02275699  ,0.02275699  ,0.02275699  ,0.02275699  ,0.02275699  ,0.02275699  ,0.02275699  ,
                    0.02275699  ,0.02275699  ,0.02275699  ,0.02275699  ,0.02275699  ,0.02275699  ,0.02187596  ,0.02043855  ,
                    0.01923494  ,0.01827591  ,0.01754616  ,0.01701912  ,0.01667385  ,0.01646795  ,0.01635245  ,0.01627801  ,
                    0.01620958  ,0.01612492  ,0.01602585  ,0.01594819  ,0.01591603  ,0.01591404  ,0.01591380  ,0.01589708  ,
                    0.01586963  ,0.01585438  ,0.01584221  ,0.01582978  ,0.01579692  ,0.01573461  ,0.01564468  ,0.01552764  ,
                    0.01539464  ,0.01526094  ,0.01514874  ,0.01506928  ,0.01499843  ,0.01493279  ,0.01486830  ,0.01479620  ,
                    0.01470729  ,0.01460295  ,0.01449444  ,0.01439954  ,0.01434552  ,0.01435402  ,0.01444255  ,0.01461324  ,
                    0.01486095  ,0.01517508  ,0.01553315  ,0.01591133  ,0.01628948  ,0.01663510  ,0.01691607  ,0.01710332  ,
                    0.01718283  ,0.01714055  ,0.01697325  ,0.01668589  ,0.01629101  ,0.01580165  ,0.01523440  ,0.01460361  ,
                    0.01392748  ,0.01321366  ,0.01247624  ,0.01174408  ,0.01103958  ,0.01036206  ,0.00971119  ,0.00907499  ,
                    0.00843666  ,0.00779132  ,0.00752827  ,0.00752827  ,0.00752827  ,0.00752827  ,0.00752827  ,0.00752827  ,
                    0.00752827  ,0.00752827  ,0.00752827  ,0.00752827  ,0.00752827  ,0.00752827  ,0.00752827  ,0.00752827  ,
                    0.00752827  ,0.00752827  ,0.00752827  ,0.00752827  ,0.00752827  ,0.00752827  ,0.00752827  ,0.00752827  ,
                    0.00752827  ,0.00752827  ,0.00752827  ,0.00752827  ,0.00752827  ,0.00752827  ,0.00752827  ,0.00752827  ,
                    0.00752827  ,0.00000000  ,                ],[
                    0.02275699  ,0.02275699  ,0.02275699  ,0.02275699  ,0.02275699  ,0.02275699  ,0.02275699  ,0.02275699  ,
                    0.02275699  ,0.02275699  ,0.02275699  ,0.02275699  ,0.02275699  ,0.02275699  ,0.02275699  ,0.02275699  ,
                    0.02275699  ,0.02275699  ,0.02275699  ,0.02275699  ,0.02275699  ,0.02275699  ,0.02275699  ,0.02271861  ,
                    0.02263210  ,0.02256532  ,0.02249365  ,0.02237620  ,0.02218451  ,0.02193800  ,0.02163226  ,0.02120050  ,
                    0.02060850  ,0.01986797  ,0.01902117  ,0.01814336  ,0.01728835  ,0.01651761  ,0.01586975  ,0.01533655  ,
                    0.01490906  ,0.01460830  ,0.01444145  ,0.01439310  ,0.01444528  ,0.01456544  ,0.01473862  ,0.01493850  ,
                    0.01515013  ,0.01537544  ,0.01560386  ,0.01583595  ,0.01605328  ,0.01622981  ,0.01635714  ,0.01643668  ,
                    0.01646429  ,0.01644797  ,0.01639497  ,0.01631005  ,0.01622323  ,0.01616781  ,0.01617782  ,0.01628093  ,
                    0.01647849  ,0.01674299  ,0.01704763  ,0.01737873  ,0.01772791  ,0.01808856  ,0.01843969  ,0.01876036  ,
                    0.01903168  ,0.01924919  ,0.01939350  ,0.01945340  ,0.01941953  ,0.01928952  ,0.01906059  ,0.01873950  ,
                    0.01832166  ,0.01780802  ,0.01720567  ,0.01652807  ,0.01579131  ,0.01500595  ,0.01419030  ,0.01335712  ,
                    0.01251967  ,0.01168026  ,0.01088382  ,0.01017249  ,0.00954608  ,0.00900445  ,0.00854744  ,0.00817495  ,
                    0.00788688  ,0.00768315  ,0.00756372  ,0.00752827  ,0.00752827  ,0.00752827  ,0.00752827  ,0.00752827  ,
                    0.00752827  ,0.00752827  ,0.00752827  ,0.00752827  ,0.00752827  ,0.00752827  ,0.00752827  ,0.00752827  ,
                    0.00752827  ,0.00752827  ,0.00752827  ,0.00752827  ,0.00752827  ,0.00752827  ,0.00752827  ,0.00752827  ,
                    0.00752827  ,0.00000000  ,                                               ]];
        private double[][] F_2_Bestand = [[
                0.02301277  ,0.02301277  ,0.02301277  ,0.02301277  ,0.02301277  ,0.02301277  ,0.02301277  ,0.02301277  ,
                0.02301277  ,0.02301277  ,0.02301277  ,0.02301277  ,0.02301277  ,0.02301277  ,0.02301277  ,0.02301277  ,
                0.02301277  ,0.02301277  ,0.02301277  ,0.02301277  ,0.02301277  ,0.02301277  ,0.02213153  ,0.02069375  ,
                0.01948983  ,0.01853055  ,0.01780062  ,0.01727345  ,0.01692808  ,0.01672213  ,0.01660660  ,0.01653215  ,
                0.01646370  ,0.01637902  ,0.01627992  ,0.01620224  ,0.01617007  ,0.01616808  ,0.01616784  ,0.01615112  ,
                0.01612366  ,0.01610841  ,0.01609623  ,0.01608380  ,0.01605093  ,0.01598861  ,0.01589865  ,0.01578158  ,
                0.01564855  ,0.01551482  ,0.01540259  ,0.01532311  ,0.01525224  ,0.01518658  ,0.01512208  ,0.01504996  ,
                0.01496103  ,0.01485665  ,0.01474813  ,0.01465320  ,0.01459917  ,0.01460766  ,0.01469622  ,0.01486696  ,
                0.01511472  ,0.01542894  ,0.01578709  ,0.01616537  ,0.01654362  ,0.01688932  ,0.01717037  ,0.01735766  ,
                0.01743720  ,0.01739490  ,0.01722756  ,0.01694013  ,0.01654515  ,0.01605567  ,0.01548827  ,0.01485732  ,
                0.01418101  ,0.01346701  ,0.01272941  ,0.01199706  ,0.01129238  ,0.01061470  ,0.00996366  ,0.00932730  ,
                0.00868881  ,0.00804331  ,0.00778019  ,0.00778019  ,0.00778019  ,0.00778019  ,0.00778019  ,0.00778019  ,
                0.00778019  ,0.00778019  ,0.00778019  ,0.00778019  ,0.00778019  ,0.00778019  ,0.00778019  ,0.00778019  ,
                0.00778019  ,0.00778019  ,0.00778019  ,0.00778019  ,0.00778019  ,0.00778019  ,0.00778019  ,0.00778019  ,
                0.00778019  ,0.00778019  ,0.00778019  ,0.00778019  ,0.00778019  ,0.00778019  ,0.00778019  ,0.00778019  ,
                0.00778019  ,0.00000000  ,],
                [0.02301277 ,0.02301277  ,0.02301277  ,0.02301277  ,0.02301277  ,0.02301277  ,0.02301277  ,0.02301277  ,
                0.02301277  ,0.02301277  ,0.02301277  ,0.02301277  ,0.02301277  ,0.02301277  ,0.02301277  ,0.02301277  ,
                0.02301277  ,0.02301277  ,0.02301277  ,0.02301277  ,0.02301277  ,0.02301277  ,0.02301277  ,0.02297439  ,
                0.02288785  ,0.02282105  ,0.02274937  ,0.02263189  ,0.02244016  ,0.02219358  ,0.02188776  ,0.02145589  ,
                0.02086374  ,0.02012302  ,0.01927600  ,0.01839797  ,0.01754275  ,0.01677181  ,0.01612378  ,0.01559045  ,
                0.01516285  ,0.01486202  ,0.01469512  ,0.01464675  ,0.01469895  ,0.01481914  ,0.01499237  ,0.01519229  ,
                0.01540398  ,0.01562935  ,0.01585783  ,0.01608998  ,0.01630736  ,0.01648393  ,0.01661129  ,0.01669085  ,
                0.01671847  ,0.01670215  ,0.01664913  ,0.01656420  ,0.01647735  ,0.01642191  ,0.01643193  ,0.01653507  ,
                0.01673268  ,0.01699724  ,0.01730196  ,0.01763314  ,0.01798242  ,0.01834316  ,0.01869438  ,0.01901512  ,
                0.01928652  ,0.01950408  ,0.01964843  ,0.01970835  ,0.01967447  ,0.01954442  ,0.01931544  ,0.01899426  ,
                0.01857632  ,0.01806254  ,0.01746004  ,0.01678227  ,0.01604532  ,0.01525976  ,0.01444390  ,0.01361051  ,
                0.01277285  ,0.01193323  ,0.01113659  ,0.01042508  ,0.00979851  ,0.00925674  ,0.00879962  ,0.00842703  ,
                0.00813889  ,0.00793511  ,0.00781565  ,0.00778019  ,0.00778019  ,0.00778019  ,0.00778019  ,0.00778019  ,
                0.00778019  ,0.00778019  ,0.00778019  ,0.00778019  ,0.00778019  ,0.00778019  ,0.00778019  ,0.00778019  ,
                0.00778019  ,0.00778019  ,0.00778019  ,0.00778019  ,0.00778019  ,0.00778019  ,0.00778019  ,0.00778019  ,
                0.00778019  ,0.00000000  ,]];
        private double[][] Grundtafel_1_O = [[
                    0.000083    ,0.000083    ,0.000083    ,0.000083    ,0.000083    ,0.000083    ,0.000083    ,0.000083    ,
                    0.000083    ,0.000083    ,0.000083    ,0.000098    ,0.000104    ,0.000114    ,0.000140    ,0.000192    ,
                    0.000276    ,0.000364    ,0.000596    ,0.000598    ,0.000598    ,0.000598    ,0.000598    ,0.000598    ,
                    0.000598    ,0.000598    ,0.000598    ,0.000598    ,0.000598    ,0.000598    ,0.000598    ,0.000605    ,
                    0.000626    ,0.000663    ,0.000713    ,0.000754    ,0.000805    ,0.000871    ,0.000940    ,0.001008    ,
                    0.001073    ,0.001137    ,0.001197    ,0.001259    ,0.001325    ,0.001395    ,0.001473    ,0.001557    ,
                    0.001644    ,0.001735    ,0.001826    ,0.001924    ,0.002023    ,0.002121    ,0.002212    ,0.002294    ,
                    0.002370    ,0.002451    ,0.002540    ,0.002649    ,0.002781    ,0.002957    ,0.003176    ,0.003432    ,
                    0.003707    ,0.003980    ,0.004270    ,0.004631    ,0.004995    ,0.005363    ,0.005744    ,0.006150    ,
                    0.006605    ,0.007122    ,0.007722    ,0.008460    ,0.009337    ,0.010403    ,0.011693    ,0.013259    ,
                    0.015167    ,0.017450    ,0.020162    ,0.023324    ,0.026970    ,0.031142    ,0.035854    ,0.041159    ,
                    0.047090    ,0.053666    ,0.060681    ,0.067908    ,0.075209    ,0.082462    ,0.089515    ,0.096209    ,
                    0.102378    ,0.107876    ,0.113045    ,0.118108    ,0.121553    ,0.126442    ,0.131302    ,0.136130    ,
                    0.140927    ,0.145690    ,0.150416    ,0.155105    ,0.159752    ,0.164354    ,0.168907    ,0.173407    ,
                    0.177848    ,0.182224    ,0.186528    ,0.190752    ,0.194887    ,0.198923    ,0.202848    ,0.206649    ,
                    0.210311    ,1.000000    ,],                [0.000066    ,0.000066    ,0.000066    ,0.000066    ,0.000066    ,0.000066    ,0.000066    ,0.000066    ,
                    0.000066    ,0.000066    ,0.000066    ,0.000071    ,0.000075    ,0.000079    ,0.000092    ,0.000120    ,
                    0.000144    ,0.000166    ,0.000201    ,0.000201    ,0.000201    ,0.000201    ,0.000201    ,0.000201    ,
                    0.000222    ,0.000225    ,0.000225    ,0.000235    ,0.000258    ,0.000280    ,0.000291    ,0.000302    ,
                    0.000318    ,0.000344    ,0.000385    ,0.000423    ,0.000464    ,0.000508    ,0.000550    ,0.000593    ,
                    0.000642    ,0.000693    ,0.000743    ,0.000788    ,0.000830    ,0.000874    ,0.000921    ,0.000971    ,
                    0.001022    ,0.001069    ,0.001111    ,0.001149    ,0.001182    ,0.001218    ,0.001259    ,0.001306    ,
                    0.001363    ,0.001430    ,0.001504    ,0.001585    ,0.001674    ,0.001771    ,0.001876    ,0.001986    ,
                    0.002096    ,0.002229    ,0.002345    ,0.002520    ,0.002732    ,0.002959    ,0.003199    ,0.003478    ,
                    0.003780    ,0.004090    ,0.004446    ,0.004864    ,0.005328    ,0.005823    ,0.006429    ,0.007203    ,
                    0.008215    ,0.009536    ,0.011237    ,0.013343    ,0.015844    ,0.018792    ,0.022273    ,0.026353    ,
                    0.031049    ,0.036366    ,0.042123    ,0.048071    ,0.054145    ,0.060268    ,0.066351    ,0.072275    ,
                    0.077904    ,0.083095    ,0.087727    ,0.091681    ,0.100158    ,0.104765    ,0.109394    ,0.114045    ,
                    0.118719    ,0.123417    ,0.128138    ,0.132883    ,0.137652    ,0.142443    ,0.147255    ,0.152087    ,
                    0.156935    ,0.161796    ,0.166665    ,0.171536    ,0.176401    ,0.181250    ,0.186074    ,0.190855    ,
                    0.195579    ,1.000000    ,                        ]];
        private double[][] Grundtafel_B20 = [[
                    0.000092    ,0.000092    ,0.000092    ,0.000092    ,0.000092    ,0.000092    ,0.000092    ,0.000092    ,
                    0.000092    ,0.000092    ,0.000092    ,0.000109    ,0.000115    ,0.000127    ,0.000155    ,0.000214    ,
                    0.000307    ,0.000405    ,0.000663    ,0.000665    ,0.000665    ,0.000665    ,0.000665    ,0.000665    ,
                    0.000665    ,0.000665    ,0.000665    ,0.000665    ,0.000665    ,0.000665    ,0.000665    ,0.000672    ,
                    0.000695    ,0.000736    ,0.000792    ,0.000861    ,0.000945    ,0.001049    ,0.001164    ,0.001281    ,
                    0.001401    ,0.001524    ,0.001648    ,0.001781    ,0.001924    ,0.002029    ,0.002144    ,0.002268    ,
                    0.002397    ,0.002529    ,0.002664    ,0.002810    ,0.002960    ,0.003108    ,0.003246    ,0.003371    ,
                    0.003487    ,0.003608    ,0.003742    ,0.003906    ,0.004108    ,0.004379    ,0.004720    ,0.005123    ,
                    0.005565    ,0.006014    ,0.006500    ,0.007102    ,0.007717    ,0.008344    ,0.008991    ,0.009674    ,
                    0.010424    ,0.011261    ,0.012210    ,0.013354    ,0.014694    ,0.016300    ,0.018223    ,0.020535    ,
                    0.023329    ,0.026642    ,0.030547    ,0.035069    ,0.040256    ,0.046164    ,0.052801    ,0.060230    ,
                    0.068472    ,0.077529    ,0.087145    ,0.097058    ,0.107098    ,0.117125    ,0.126959    ,0.136406    ,
                    0.145265    ,0.153355    ,0.161069    ,0.168666    ,0.173981    ,0.181392    ,0.188792    ,0.196181    ,
                    0.203556    ,0.210915    ,0.218255    ,0.225570    ,0.232858    ,0.240111    ,0.247326    ,0.254493    ,
                    0.261605    ,0.268653    ,0.275625    ,0.282509    ,0.289291    ,0.295955    ,0.302482    ,0.308852    ,
                    0.315042    ,1.000000    ,               ],            [
                     0.000073   ,0.000073    ,0.000073    ,0.000073    ,0.000073    ,0.000073    ,0.000073    ,0.000073    ,
                    0.000073    ,0.000073    ,0.000073    ,0.000079    ,0.000083    ,0.000088    ,0.000102    ,0.000134    ,
                    0.000161    ,0.000185    ,0.000223    ,0.000223    ,0.000223    ,0.000223    ,0.000223    ,0.000223    ,
                    0.000246    ,0.000250    ,0.000250    ,0.000261    ,0.000287    ,0.000311    ,0.000323    ,0.000335    ,
                    0.000353    ,0.000383    ,0.000427    ,0.000482    ,0.000543    ,0.000608    ,0.000672    ,0.000740    ,
                    0.000817    ,0.000899    ,0.000983    ,0.001066    ,0.001148    ,0.001212    ,0.001284    ,0.001361    ,
                    0.001439    ,0.001514    ,0.001582    ,0.001645    ,0.001702    ,0.001761    ,0.001827    ,0.001902    ,
                    0.001990    ,0.002094    ,0.002204    ,0.002326    ,0.002459    ,0.002606    ,0.002766    ,0.002940    ,
                    0.003119    ,0.003335    ,0.003532    ,0.003822    ,0.004172    ,0.004552    ,0.004956    ,0.005425    ,
                    0.005930    ,0.006450    ,0.007042    ,0.007727    ,0.008481    ,0.009274    ,0.010231    ,0.011439    ,
                    0.013002    ,0.015024    ,0.017599    ,0.020754    ,0.024456    ,0.028766    ,0.033797    ,0.039628    ,
                    0.046269    ,0.053701    ,0.061676    ,0.069869    ,0.078210    ,0.086615    ,0.094985    ,0.103179    ,
                    0.111033    ,0.118374    ,0.125055    ,0.130927    ,0.143358    ,0.150295    ,0.157293    ,0.164354    ,
                    0.171479    ,0.178671    ,0.185929    ,0.193253    ,0.200644    ,0.208101    ,0.215622    ,0.223204    ,
                    0.230844    ,0.238536    ,0.246274    ,0.254049    ,0.261850    ,0.269662    ,0.277468    ,0.285248    ,
                    0.292973    ,1.000000    ,                        ]];
        private double[][] Grundtafel_Bestand = [[
                0.000092    ,0.000092    ,0.000092    ,0.000092    ,0.000092    ,0.000092    ,0.000092    ,0.000092    ,
                0.000092    ,0.000092    ,0.000092    ,0.000109    ,0.000115    ,0.000127    ,0.000155    ,0.000214    ,
                0.000307    ,0.000405    ,0.000663    ,0.000665    ,0.000665    ,0.000665    ,0.000665    ,0.000665    ,
                0.000665    ,0.000665    ,0.000665    ,0.000665    ,0.000665    ,0.000665    ,0.000665    ,0.000672    ,
                0.000695    ,0.000736    ,0.000792    ,0.000861    ,0.000945    ,0.001049    ,0.001164    ,0.001281    ,
                0.001401    ,0.001524    ,0.001648    ,0.001781    ,0.001924    ,0.002029    ,0.002144    ,0.002268    ,
                0.002397    ,0.002529    ,0.002664    ,0.002815    ,0.002974    ,0.003138    ,0.003299    ,0.003453    ,
                0.003601    ,0.003755    ,0.003925    ,0.004129    ,0.004376    ,0.004701    ,0.005109    ,0.005594    ,
                0.006131    ,0.006688    ,0.007301    ,0.008059    ,0.008850    ,0.009671    ,0.010530    ,0.011444    ,
                0.012448    ,0.013562    ,0.014817    ,0.016312    ,0.018046    ,0.020106    ,0.022552    ,0.025474    ,
                0.028982    ,0.033119    ,0.037970    ,0.043567    ,0.049975    ,0.057258    ,0.065421    ,0.074528    ,
                0.084578    ,0.095548    ,0.105787    ,0.115238    ,0.124748    ,0.134291    ,0.143813    ,0.153263    ,
                0.162599    ,0.171791    ,0.180888    ,0.189898    ,0.196377    ,0.205259    ,0.214172    ,0.223117    ,
                0.232090    ,0.241088    ,0.250107    ,0.259143    ,0.268191    ,0.277244    ,0.286295    ,0.295336    ,
                0.304356    ,0.313345    ,0.322289    ,0.331173    ,0.339979    ,0.348689    ,0.357280    ,0.365725    ,
                0.373997    ,1.000000    ,       ],[
                 0.000073   ,0.000073    ,0.000073    ,0.000073    ,0.000073    ,0.000073    ,0.000073    ,0.000073    ,
                0.000073    ,0.000073    ,0.000073    ,0.000079    ,0.000083    ,0.000088    ,0.000102    ,0.000134    ,
                0.000161    ,0.000185    ,0.000223    ,0.000223    ,0.000223    ,0.000223    ,0.000223    ,0.000223    ,
                0.000246    ,0.000250    ,0.000250    ,0.000261    ,0.000287    ,0.000311    ,0.000323    ,0.000335    ,
                0.000353    ,0.000383    ,0.000427    ,0.000482    ,0.000543    ,0.000608    ,0.000672    ,0.000740    ,
                0.000817    ,0.000899    ,0.000983    ,0.001066    ,0.001148    ,0.001212    ,0.001284    ,0.001361    ,
                0.001439    ,0.001514    ,0.001582    ,0.001647    ,0.001708    ,0.001773    ,0.001848    ,0.001934    ,
                0.002035    ,0.002153    ,0.002279    ,0.002417    ,0.002569    ,0.002737    ,0.002921    ,0.003123    ,
                0.003334    ,0.003589    ,0.003828    ,0.004173    ,0.004591    ,0.005049    ,0.005543    ,0.006118    ,
                0.006744    ,0.007394    ,0.008134    ,0.008988    ,0.009927    ,0.010914    ,0.012095    ,0.013569    ,
                0.015460    ,0.017884    ,0.020946    ,0.024667    ,0.028996    ,0.033986    ,0.039756    ,0.046377    ,
                0.053839    ,0.062095    ,0.070867    ,0.079822    ,0.088901    ,0.098033    ,0.107136    ,0.116083    ,
                0.124729    ,0.132917    ,0.140520    ,0.147409    ,0.161812    ,0.170070    ,0.178439    ,0.186919    ,
                0.195516    ,0.204230    ,0.213063    ,0.222016    ,0.231089    ,0.240283    ,0.249596    ,0.259025    ,
                0.268568    ,0.278218    ,0.287969    ,0.297810    ,0.307730    ,0.317711    ,0.327734    ,0.337774    ,
                0.347799    ,1.000000    ,       ]];
        private double[][] Selektionstafel_1_O = [[
                    0.002546    ,0.000234    ,0.000158    ,0.000117    ,0.000090    ,0.000080    ,0.000076    ,0.000065    ,
                    0.000073    ,0.000062    ,0.000061    ,0.000073    ,0.000077    ,0.000084    ,0.000103    ,0.000142    ,
                    0.000205    ,0.000270    ,0.000442    ,0.000467    ,0.000464    ,0.000471    ,0.000463    ,0.000475    ,
                    0.000460    ,0.000457    ,0.000456    ,0.000471    ,0.000485    ,0.000502    ,0.000515    ,0.000546    ,
                    0.000568    ,0.000601    ,0.000653    ,0.000697    ,0.000751    ,0.000821    ,0.000878    ,0.000968    ,
                    0.001083    ,0.001169    ,0.001288    ,0.001403    ,0.001532    ,0.001719    ,0.001872    ,0.002074    ,
                    0.002268    ,0.002526    ,0.002838    ,0.003029    ,0.003358    ,0.003684    ,0.004054    ,0.004419    ,
                    0.004872    ,0.005388    ,0.005888    ,0.006541    ,0.007226    ,0.007922    ,0.008590    ,0.009229    ,
                    0.009933    ,0.010714    ,0.011662    ,0.012834    ,0.014099    ,0.015456    ,0.016920    ,0.018547    ,
                    0.020408    ,0.022511    ,0.024873    ,0.027614    ,0.030689    ,0.034200    ,0.038203    ,0.042787    ,
                    0.048081    ,0.054068    ,0.060821    ,0.068363    ,0.076782    ,0.086113    ,0.096295    ,0.107306    ,
                    0.118973    ,0.131124    ,0.143616    ,0.156454    ,0.169564    ,0.182946    ,0.196568    ,0.210397    ,
                    0.224411    ,0.238604    ,0.252947    ,0.267377    ,0.278816    ,0.293701    ,0.308850    ,0.324261    ,
                    0.339936    ,0.355873    ,0.372069    ,0.388523    ,0.405229    ,0.422180    ,0.439368    ,0.456782    ,
                    0.474411    ,0.492237    ,0.510241    ,0.528401    ,0.546689    ,0.565074    ,0.583517    ,0.601976    ,
                    0.620400    ,1.000000    ,               ],[
                    0.002549    ,0.000265    ,0.000152    ,0.000117    ,0.000095    ,0.000074    ,0.000076    ,0.000076    ,
                    0.000065    ,0.000065    ,0.000062    ,0.000067    ,0.000071    ,0.000075    ,0.000087    ,0.000114    ,
                    0.000137    ,0.000157    ,0.000223    ,0.000225    ,0.000218    ,0.000199    ,0.000203    ,0.000190    ,
                    0.000210    ,0.000213    ,0.000213    ,0.000222    ,0.000244    ,0.000265    ,0.000275    ,0.000292    ,
                    0.000329    ,0.000357    ,0.000401    ,0.000445    ,0.000498    ,0.000561    ,0.000606    ,0.000656    ,
                    0.000743    ,0.000823    ,0.000903    ,0.001000    ,0.001079    ,0.001200    ,0.001291    ,0.001395    ,
                    0.001553    ,0.001650    ,0.001823    ,0.001965    ,0.002089    ,0.002262    ,0.002470    ,0.002623    ,
                    0.002877    ,0.003106    ,0.003391    ,0.003731    ,0.004121    ,0.004492    ,0.004862    ,0.005195    ,
                    0.005504    ,0.005827    ,0.006266    ,0.006904    ,0.007701    ,0.008612    ,0.009637    ,0.010869    ,
                    0.012266    ,0.013782    ,0.015522    ,0.017516    ,0.019686    ,0.021922    ,0.024477    ,0.027510    ,
                    0.031211    ,0.035743    ,0.041240    ,0.047641    ,0.054741    ,0.062514    ,0.071076    ,0.080444    ,
                    0.090508    ,0.101071    ,0.111814    ,0.122478    ,0.133104    ,0.143725    ,0.154369    ,0.165023    ,
                    0.175662    ,0.186250    ,0.196808    ,0.207342    ,0.229739    ,0.243350    ,0.257319    ,0.271655    ,0.286368    ,
                    0.301467    ,0.316962    ,0.332860    ,0.349169    ,0.365896    ,0.383046    ,0.400622    ,0.418626    ,
                    0.437055    ,0.455906    ,0.475170    ,0.494832    ,0.514872    ,0.535264    ,0.555969    ,0.576942    ,1.000000    ,                        ]];
        private double[][] Selektionstafel_2_O = [ [
            0.003018  ,0.000278    ,0.000187    ,0.000139    ,0.000107    ,0.000095    ,0.000090    ,0.000077    ,
            0.000087    ,0.000074    ,0.000073    ,0.000086    ,0.000091    ,0.000100    ,0.000122    ,0.000169    ,
            0.000243    ,0.000320    ,0.000523    ,0.000553    ,0.000550    ,0.000558    ,0.000548    ,0.000563    ,
            0.000546    ,0.000541    ,0.000540    ,0.000558    ,0.000574    ,0.000595    ,0.000610    ,0.000647    ,
            0.000674    ,0.000712    ,0.000774    ,0.000826    ,0.000890    ,0.000973    ,0.001041    ,0.001148    ,
            0.001284    ,0.001386    ,0.001527    ,0.001663    ,0.001815    ,0.002038    ,0.002219    ,0.002458    ,
            0.002688    ,0.002994    ,0.003364    ,0.003591    ,0.003980    ,0.004366    ,0.004805    ,0.005238    ,
            0.005775    ,0.006387    ,0.006980    ,0.007753    ,0.008565    ,0.009390    ,0.010182    ,0.010939    ,
            0.011774    ,0.012699    ,0.013823    ,0.015212    ,0.016712    ,0.018321    ,0.020056    ,0.021984    ,
            0.024190    ,0.026683    ,0.029483    ,0.032731    ,0.036376    ,0.040539    ,0.045283    ,0.050717    ,
            0.056992    ,0.064088    ,0.072092    ,0.081033    ,0.091012    ,0.102071    ,0.114141    ,0.127192    ,
            0.141021    ,0.155425    ,0.170231    ,0.185449    ,0.200989    ,0.21685 ,0.232997    ,0.249388    ,
            0.265999    ,0.282823   ,0.299824    ,0.316929    ,0.330487    ,0.348131    ,0.366086    ,0.384354    ,
            0.402934    ,0.421824    ,0.441023    ,0.460525    ,0.480327    ,0.500419    ,0.520793    ,0.541435    ,
            0.562330    ,0.583459    ,0.604801    ,0.626326    ,0.648003    ,0.669795    ,0.691657    ,0.713536    ,0.735375    ,1.000000    ,],
        [
                        0.003053    ,0.000317    ,0.000182    ,0.000140    ,0.000114    ,0.000089    ,0.000091    ,0.000091    ,
            0.000078    ,0.000077    ,0.000075    ,0.000081    ,0.000085    ,0.000089    ,0.000104    ,0.000136    ,
            0.000164    ,0.000188    ,0.000267    ,0.000269    ,0.000260    ,0.000239    ,0.000243    ,0.000227    ,
            0.000251    ,0.000255    ,0.000255    ,0.000266    ,0.000293    ,0.000317    ,0.000329    ,0.000350    ,
            0.000394    ,0.000427    ,0.000480    ,0.000533    ,0.000596    ,0.000671    ,0.000725    ,0.000785    ,
            0.000890    ,0.000986    ,0.001082    ,0.001198    ,0.001292    ,0.001437    ,0.001546    ,0.001671    ,
            0.001860    ,0.001976    ,0.002183    ,0.002353    ,0.002502    ,0.002709    ,0.002957    ,0.003141    ,
            0.003445    ,0.003720    ,0.004061    ,0.004468    ,0.004935    ,0.005379    ,0.005822    ,0.006221    ,
            0.006591    ,0.006977    ,0.007504    ,0.008268    ,0.009222    ,0.010313    ,0.011540    ,0.013015    ,
            0.014689    ,0.016504    ,0.018588    ,0.020976    ,0.023574    ,0.026251    ,0.029312    ,0.032944    ,
            0.037376    ,0.042803    ,0.049385    ,0.057051    ,0.065553    ,0.074862    ,0.085115    ,0.096333    ,
            0.108385    ,0.121035    ,0.133899    ,0.146670    ,0.159395    ,0.172113    ,0.18486 ,0.197618    ,
            0.210358    ,0.223038    ,0.235681    ,0.248296    ,0.275117    ,0.291416    ,0.308144    ,0.325311    ,
            0.342930    ,0.361012    ,0.379567    ,0.398606    ,0.418136    ,0.438167    ,0.458705    ,0.479752    ,
            0.501312    ,0.523382    ,0.545956    ,0.569024    ,0.592570    ,0.616569    ,0.640988    ,0.665783    ,
            0.690898    ,1.000000    ,                               ]];
        private string Ordnung = "1.O.Selektion";
        public DAV2004(double t_1, double t_2, int policenbeginnjahr, int eintrittsalter, int N, List<Tafel> tafelListe, string ordnung)
        {
            T_1 = t_1;
            T_2 = t_2;
            Ordnung = ordnung;
            Policenbeginnjahr = policenbeginnjahr;
            Eintrittsalter = eintrittsalter;
            n = N;
            TafelListe = tafelListe;
            BerechneGewichte();
            TafelListe = BerechneTafeln(TafelListe);
        }
        public DAV2004() { }

        public void BerechneGewichte()
        {
            int index = 0;
            for (int i = 1999; i <= 2200; i++)
            {
                double faktor = (i - 1999);
                if (i <= 1999.0 + T_1)
                {
                    Gewichte[index] = 1.0;
                }
                else
                {
                    if (i <= 1999.0 + T_2)
                    {
                        Gewichte[index] = 1 - (i - 1999.0 - T_1) * (i - 1999.0 - T_1 - 1) / (2 * (T_2 - T_1) * (i - 1999.0));
                    }
                    else
                    {
                        Gewichte[index] = (T_1 + T_2 + 1) / (2 * (i - 1999.0));
                    }
                }
                Gewichte[index] = Math.Round(Gewichte[index] * faktor, 12);
                index++;
            }

        }
        public List<Tafel> BerechneTafeln(List<Tafel> tafelListe)
        {

            for (int x = 0; x < 2; x++)
            {
                int jahr = Policenbeginnjahr;
                for (int i = Eintrittsalter; i <= 121; i++)
                {

                    double faktor_2 = F_2_2_O[x][i] * (jahr - 1999.0);
                    faktor_2 += Gewichte[jahr - 1998] * (F_1_2_O[x][i] - F_2_2_O[x][i]);
                    faktor_2 = Math.Exp(-faktor_2);

                    double faktor_1 = F_1_O[x][i] * (jahr - 1999.0);
                    faktor_1 = Math.Exp(-faktor_1);

                    double ordnung2_Selektion = 0.0;
                    double ordnung1_Selektion = 0.0;
                    double ordnung2_Aggregat = Aggregattafel_2_O[x][i] * faktor_2;
                    double ordnung1_Aggregat = Aggregattafel_1_O[x][i] * faktor_1;
                    if (i < Eintrittsalter + n)
                    {
                        ordnung2_Selektion = Aggregattafel_2_O[x][i];
                        ordnung1_Selektion = Aggregattafel_1_O[x][i];
                    }
                    else
                    {
                        if (i == Eintrittsalter + n)
                        {
                            ordnung2_Selektion = f[x][0];
                            ordnung1_Selektion = f[x][0];
                        }
                        else
                        {
                            if (i > Eintrittsalter + n && i < Eintrittsalter + n + 5)
                            {
                                ordnung2_Selektion = f[x][1];
                                ordnung1_Selektion = f[x][1];
                            }
                            else
                            {
                                ordnung2_Selektion = 1.0;
                                ordnung1_Selektion = 1.0;
                            }
                        }
                        ordnung2_Selektion *= Selektionstafel_2_O[x][i];
                        ordnung1_Selektion *= Selektionstafel_1_O[x][i];
                    }
                    ordnung2_Selektion *= faktor_2;
                    ordnung1_Selektion *= faktor_1;

                    double qx_end = 0.0;

                    if (Ordnung == "1.O. Selektion")
                        qx_end = ordnung1_Selektion;
                    else if (Ordnung == "1.O. Aggregat")
                        qx_end = ordnung1_Aggregat;
                    else if (Ordnung == "2.O. Selektion")
                        qx_end = ordnung2_Selektion;
                    else //2.O. Aggregat
                        qx_end = ordnung2_Aggregat;


                    if (x == 0)
                        tafelListe[i].QX = qx_end;

                    else
                        tafelListe[i].QY = qx_end;
                    jahr++;
                }
            }
            return tafelListe;
        }
    }
}
